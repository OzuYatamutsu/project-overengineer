FROM redis:7

ENV REDIS_REPLICA_PORT=6379
ENV REDIS_HOST=redis
ENV REDIS_PORT=6379
# ENV REDIS_PASSWORD

# Install local vault certificates
RUN apt-get update && apt-get install -y ca-certificates
COPY vault-ca.crt /usr/local/share/ca-certificates/vault-ca.crt
RUN update-ca-certificates

CMD redis-server --bind 0.0.0.0 --port "$REDIS_REPLICA_PORT" --replicaof "$REDIS_HOST" "$REDIS_PORT" --masterauth "$REDIS_PASSWORD"
