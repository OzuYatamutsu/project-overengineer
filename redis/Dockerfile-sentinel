FROM redis:7

ENV SENTINEL_PORT=26379
ENV REDIS_HOST=redis
ENV REDIS_PORT=6379
# ENV REDIS_PASSWORD

# Generate config file
RUN cat <<EOF >> /etc/sentinel.conf
bind 0.0.0.0
port ${SENTINEL_PORT}
sentinel monitor redis-master ${REDIS_HOST} ${REDIS_PORT} 2
sentinel auth-pass redis-master ${REDIS_PASSWORD}
sentinel down-after-milliseconds redis-master 5000
sentinel parallel-syncs redis-master 1
sentinel failover-timeout redis-master 10000
sentinel resolve-hostnames yes
EOF

CMD redis-sentinel /etc/sentinel.conf
